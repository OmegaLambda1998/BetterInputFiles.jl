<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · BetterInputFiles Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="BetterInputFiles Documentation logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="BetterInputFiles Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">BetterInputFiles Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">BetterInputFiles</a></li><li class="is-active"><a class="tocitem" href>Advanced Usage</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Input-file-options"><span>Input file options</span></a></li><li><a class="tocitem" href="#Script-options"><span>Script options</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Advanced Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/OmegaLambda1998/BetterInputFiles.jl/blob/main/doc/src/advanced.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Usage"><a class="docs-heading-anchor" href="#Advanced-Usage">Advanced Usage</a><a id="Advanced-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Usage" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Advanced-Usage">Advanced Usage</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Input-file-options">Input file options</a></li><li><a href="#Script-options">Script options</a></li></ul></li></ul><p>Most of my packages use the same boilerplate to setup everything in a way that allows easy access propogation of user provided parameters:</p><pre><code class="language-julia hljs">using BetterInputFiles
using ArgParse

function get_args()
    s = ArgParseSettings()
    @add_arg_table s begin
        &quot;--verbose&quot;, &quot;-v&quot;
            help = &quot;Increase level of logging verbosity&quot;
            action = :store_true
        &quot;input&quot;
            help = &quot;Path to input file&quot;
            required = true
    end
    return parse_args(s)
end

function main()
    args = get_args()
    verbose = args[&quot;verbose&quot;]
    input_path = args[&quot;input&quot;]
    input = setup_input(toml, verbose)
    @debug &quot;Read in $input_path&quot;
    run_MyPackage(input) # Actually run everything with the prepared `input`
end</code></pre><p>Given an input file, this will produce a dictionary with a <code>global</code> key containing a dictionary with</p><ul><li><code>input_path</code>: The directory the input file is stored in</li><li><code>base_path</code>: A base path defined relative to <code>input_path</code> from which any relative paths used by the package will be relative to</li><li><code>output_path</code>: The output directory where all output, including logging, will be put</li><li><code>logging</code>: Whether logging was set up. This allows you to use my BetterInputFiles logging function or your own</li><li><code>log_file</code>: If using my logging function, then in addition to <code>stdout</code>, logs will be saved to <code>log_file</code></li></ul><h2 id="Input-file-options"><a class="docs-heading-anchor" href="#Input-file-options">Input file options</a><a id="Input-file-options-1"></a><a class="docs-heading-anchor-permalink" href="#Input-file-options" title="Permalink"></a></h2><p>Much of the behaviour can be controlled from the input file itself, without needed to change any code. Note that all of these examples are written in TOML, but will work for YAML, and JSON files as well.</p><h3 id="Change-default-paths"><a class="docs-heading-anchor" href="#Change-default-paths">Change default paths</a><a id="Change-default-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Change-default-paths" title="Permalink"></a></h3><p>By default, BetterInputFiles sets <code>base_path</code> equal to <code>input_path</code>, and <code>output_path</code> equal to <code>base_path/Output</code>. By defining your own (absolute or relative) <code>base_path</code>, and <code>output_path</code>, you can change these defaults. Note that <code>base_path</code> is defined relative to <code>input_path</code>, and <code>output_path</code> is defined relative to <code>base_path</code>, but absolute paths are respected.</p><pre><code class="language-toml hljs">[ global ]
    base_path = &quot;../Examples&quot;
    # base_path = input_path/../Examples
    output_path = &quot;/tmp/test&quot;
    # output_path = &quot;/tmp/test&quot;</code></pre><h3 id="Change-logging-behaviour"><a class="docs-heading-anchor" href="#Change-logging-behaviour">Change logging behaviour</a><a id="Change-logging-behaviour-1"></a><a class="docs-heading-anchor-permalink" href="#Change-logging-behaviour" title="Permalink"></a></h3><p>You can define in the input file, whether you want to use BetterInputFiles logging or not. Additionally you can specify a new location for the log file (defaults to <code>output_path/log.txt</code>). This can be either absolute, or relative to <code>output_path</code>.</p><pre><code class="language-toml hljs">[ global ]
    logging = false
    log_file = logs/out.txt
    # log_file = output_path/logs/out.txt</code></pre><h3 id="Include-another-input-file"><a class="docs-heading-anchor" href="#Include-another-input-file">Include another input file</a><a id="Include-another-input-file-1"></a><a class="docs-heading-anchor-permalink" href="#Include-another-input-file" title="Permalink"></a></h3><p>It is sometimes helpful to seperate your input into a number of different files, or to use the same input options in a number of different files.</p><pre><code class="language-toml hljs"># file_1.toml
[ key1 ]
    a = 1
    b = 2

# file_2.toml
&lt;include file_1.toml&gt;

[ key2 ]
    c = 3
    d = 4</code></pre><pre><code class="language-julia hljs">input = setup_input(&quot;file_2.toml&quot;, verbose)</code></pre><p>Will produce:</p><pre><code class="language-toml hljs">[ key1 ]
    a = 1
    b = 2

[ key2 ]
    c = 3
    d = 4</code></pre><h3 id="Interpolate-Environmental-Variables"><a class="docs-heading-anchor" href="#Interpolate-Environmental-Variables">Interpolate Environmental Variables</a><a id="Interpolate-Environmental-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolate-Environmental-Variables" title="Permalink"></a></h3><p>You can easily interpolate environmental variables via:</p><pre><code class="language-toml hljs">[ key1 ]
    a = &lt;$A&gt;
    b = &lt;$B&gt;</code></pre><h3 id="Generic-Interpolation"><a class="docs-heading-anchor" href="#Generic-Interpolation">Generic Interpolation</a><a id="Generic-Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-Interpolation" title="Permalink"></a></h3><p>You can also interpolate other keys, as long as they belong to the same subtree, allowing for easy duplication.</p><pre><code class="language-toml hljs">[ key1 ]
    a = 1
    b = &lt;%a&gt;</code></pre><h3 id="Propogate-defaults"><a class="docs-heading-anchor" href="#Propogate-defaults">Propogate defaults</a><a id="Propogate-defaults-1"></a><a class="docs-heading-anchor-permalink" href="#Propogate-defaults" title="Permalink"></a></h3><p>You can specify default values which will be available under every key. These are also quite useful when combined with interpolation, as this default value will be part of every base key. If a default key is specified already, then the default will be ignored</p><pre><code class="language-toml hljs">[ DEFAULT ]
    a = 1
    b = 2

[ key1 ]
    c = &lt;%a&gt;
    d = &lt;%b&gt;</code></pre><h3 id="Automatic-upper-case"><a class="docs-heading-anchor" href="#Automatic-upper-case">Automatic upper-case</a><a id="Automatic-upper-case-1"></a><a class="docs-heading-anchor-permalink" href="#Automatic-upper-case" title="Permalink"></a></h3><p>Finally, BetterInputFiles will automatically make every key upper-case, so your user&#39;s can ignore case when specifying keys. Values are still case-specific.</p><h2 id="Script-options"><a class="docs-heading-anchor" href="#Script-options">Script options</a><a id="Script-options-1"></a><a class="docs-heading-anchor-permalink" href="#Script-options" title="Permalink"></a></h2><p>In addition to changing behaviour from the input file, there&#39;s also a lot of functionality BetterInputFiles provides when writing scripts </p><h3 id="Add-new-global-paths"><a class="docs-heading-anchor" href="#Add-new-global-paths">Add new global paths</a><a id="Add-new-global-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Add-new-global-paths" title="Permalink"></a></h3><p>By defining an <code>OrderedDict{String, Tuple{String, String}}</code> of paths, you can add new global paths, which can be accessed throughout the package. The following creates <code>data_path</code> relative to <code>base_path</code>, and <code>filter_path</code> relative to <code>data_path</code>. You must provide defaults for these paths but the user can overwrite then in the <code>.toml</code> (see <a href="#Change-default-paths">Change default paths</a>).</p><pre><code class="language-julia hljs">paths = Dict(
    # Name of path =&gt; (relative parent, default)
    &quot;data_path&quot; =&gt; (&quot;base_path&quot;, &quot;Data&quot;)
    &quot;filter_path&quot; =&gt; (&quot;data_path&quot;, &quot;Filters&quot;)

input = setup_input(input_path, verbose; paths=paths) </code></pre><h3 id="Custom-Metadata"><a class="docs-heading-anchor" href="#Custom-Metadata">Custom Metadata</a><a id="Custom-Metadata-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Metadata" title="Permalink"></a></h3><p>By providing BetterInputFiles with a <code>Vector{Tuple{String, String}}</code>, you can add additional metadata to the input file, in addition to the date of creation and original input file.</p><pre><code class="language-julia hljs">custom_metadata = [(&quot;Custom&quot;, &quot;Metadata&quot;)]

input = setup_input(input_path, verbose; custom_metadata=custom_metadata)</code></pre><p>This will create a new <code>key=&quot;Custom&quot;</code> and <code>value=&quot;Metadata&quot;</code> in the <code>Metadata</code> dictionary.</p><h3 id="Manually-set-extension"><a class="docs-heading-anchor" href="#Manually-set-extension">Manually set extension</a><a id="Manually-set-extension-1"></a><a class="docs-heading-anchor-permalink" href="#Manually-set-extension" title="Permalink"></a></h3><p>Sometimes you will have an input file which acts like a TOML, YAML, or JSON file, but has a different extension. If this is the case, you can let BetterInputFiles know which extension to assume.</p><pre><code class="language-julia hljs">input = setup_input(&quot;/path/to/input.example&quot;, verbose, &quot;toml&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« BetterInputFiles</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 8 August 2023 05:51">Tuesday 8 August 2023</span>. Using Julia version 1.11.0-DEV.239.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
