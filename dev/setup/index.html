<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Setup functions · InputFiles Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.png" alt="InputFiles Documentation logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="InputFiles Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">InputFiles Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">InputFiles</a></li><li class="is-active"><a class="tocitem" href>Setup functions</a><ul class="internal"><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Setup functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Setup functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/OmegaLambda1998/InputFiles.jl/blob/main/doc/src/setup.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Setup-Functions"><a class="docs-heading-anchor" href="#Setup-Functions">Setup Functions</a><a id="Setup-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Setup-Functions" title="Permalink"></a></h1><p>The main functionality provided by <code>InputFiles</code> is the ability to consistently setup packages from a <code>.toml</code> file.</p><ul><li><a href="#Setup-Functions">Setup Functions</a></li><li class="no-marker"><ul><li><a href="#Usage">Usage</a></li><li class="no-marker"><ul><li><a href="#Global-Options">Global Options</a></li><li class="no-marker"><ul><li><a href="#Toml-Options">Toml Options</a></li><li class="no-marker"><ul><li><a href="#Change-default-paths">Change default paths</a></li><li><a href="#Change-logging-behaviour">Change logging behaviour</a></li></ul></li><li><a href="#InputFiles-Options">InputFiles Options</a></li><li class="no-marker"><ul><li><a href="#Add-new-global-paths">Add new global paths</a></li></ul></li></ul></li></ul></li><li><a href="#API">API</a></li><li class="no-marker"><ul><li><a href="#Public-objects">Public objects</a></li><li><a href="#Private-objects">Private objects</a></li></ul></li></ul></li></ul><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>Most of my packages use the same boilerplate to setup everything in a way that allows easy access propogation of user provided parameters:</p><pre><code class="language-julia hljs">using TOML
using InputFiles
using ArgParse

function get_args()
    s = ArgParseSettings()
    @add_arg_table s begin
        &quot;--verbose&quot;, &quot;-v&quot;
            help = &quot;Increase level of logging verbosity&quot;
            action = :store_true
        &quot;input&quot;
            help = &quot;Path to .toml file&quot;
            required = true
    end
    return parse_args(s)
end

function main()
    args = get_args()
    verbose = args[&quot;verbose&quot;]
    toml_path = args[&quot;input&quot;]
    toml = TOML.parsefile(abspath(toml_path))
    setup_global!(toml, verbose, toml_path)
    @debug &quot;Read in $toml_path&quot;
    run_MyPackage(toml) # Actually run everything with the prepared `toml`
end</code></pre><p>Given a <code>.toml</code> file, this will produce a dictionary with a <code>global</code> key containing a dictionary with</p><ul><li><code>toml_path</code>: The path to the <code>.toml</code> input file</li><li><code>base_path</code>: A base path defined relative to <code>toml_path</code> from which any relative paths used by the package will be relative to</li><li><code>output_path</code>: The output directory where all output, including logging, will be put</li><li><code>logging</code>: Whether logging was set up. This allows you to use my InputFiles logging function or your own</li><li><code>log_file</code>: If using my logging function, then in addition to <code>stdout</code>, logs will be saved to <code>log_file</code></li></ul><h3 id="Global-Options"><a class="docs-heading-anchor" href="#Global-Options">Global Options</a><a id="Global-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Global-Options" title="Permalink"></a></h3><p>You can change much of the behaviour of InputFiles setup logic both in how you call it, and in <code>global</code> options in the input <code>.toml</code> file.</p><h4 id="Toml-Options"><a class="docs-heading-anchor" href="#Toml-Options">Toml Options</a><a id="Toml-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Toml-Options" title="Permalink"></a></h4><p>Much of the behaviour can be controlled from the <code>.toml</code> file itself, without needed to change any code.</p><h5 id="Change-default-paths"><a class="docs-heading-anchor" href="#Change-default-paths">Change default paths</a><a id="Change-default-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Change-default-paths" title="Permalink"></a></h5><p>By default, InputFiles sets <code>base_path</code> equal to <code>toml_path</code>, and <code>output_path</code> equal to <code>base_path/Output</code>. By defining your own (absolute or relative) <code>base_path</code>, and <code>output_path</code>, you can change these defaults. Note that <code>base_path</code> is defined relative to <code>toml_path</code>, and <code>output_path</code> is defined relative to <code>base_path</code>, but absolute paths are respected.</p><pre><code class="language-toml hljs">[ global ]
    base_path = &quot;../Examples&quot;
    # base_path = toml_path/../Examples
    output_path = &quot;/tmp/test&quot;
    # output_path = &quot;/tmp/test&quot;</code></pre><h5 id="Change-logging-behaviour"><a class="docs-heading-anchor" href="#Change-logging-behaviour">Change logging behaviour</a><a id="Change-logging-behaviour-1"></a><a class="docs-heading-anchor-permalink" href="#Change-logging-behaviour" title="Permalink"></a></h5><p>You can define in the <code>.toml</code> file, whether you want to use InputFiles logging or not. Additionally you can specify a new location for the log file (defaults to <code>output_path/log.txt</code>). This can be either absolute, or relative to <code>output_path</code></p><pre><code class="language-toml hljs">[ global ]
    logging = false
    log_file = logs/out.txt
    # log_file = output_path/logs/out.txt</code></pre><h4 id="InputFiles-Options"><a class="docs-heading-anchor" href="#InputFiles-Options">InputFiles Options</a><a id="InputFiles-Options-1"></a><a class="docs-heading-anchor-permalink" href="#InputFiles-Options" title="Permalink"></a></h4><h5 id="Add-new-global-paths"><a class="docs-heading-anchor" href="#Add-new-global-paths">Add new global paths</a><a id="Add-new-global-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Add-new-global-paths" title="Permalink"></a></h5><p>By defining a <code>Dict</code> of paths, you can add new global paths, which can be accessed throughout the package. The following creates <code>data_path</code> relative to <code>base_path</code>, and <code>filter_path</code> relative to <code>data_path</code>. You must provide defaults for these paths but the user can overwrite then in the <code>.toml</code> (see <a href="#Change-default-paths">Change default paths</a>).</p><pre><code class="language-julia hljs">paths = Dict(
    &quot;data_path&quot; =&gt; (&quot;base_path&quot;, &quot;Data&quot;)
    &quot;filter_path&quot; =&gt; (&quot;data_path&quot;, &quot;Filters&quot;)

setup_global!(toml, toml_path, paths)</code></pre><p>See <a href="#InputFiles.SetupModule.default_paths"><code>default_paths</code></a> for more details.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Public-objects"><a class="docs-heading-anchor" href="#Public-objects">Public objects</a><a id="Public-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Public-objects" title="Permalink"></a></h3><p>These are the functions, types, and other objects you have access to with a simple <code>using InputFiles</code></p><article class="docstring"><header><a class="docstring-binding" id="InputFiles.SetupModule.setup_global!" href="#InputFiles.SetupModule.setup_global!"><code>InputFiles.SetupModule.setup_global!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">setup_global!(input::Dict, input_path::AbstractString, verbose::Bool, paths::OrderedDict{String, Tuple{String, String}}=OrderedDict{String, Tuple{String, String}}(), log_path::String=&quot;output_path&quot;; test::Bool=false)</code></pre><p>Setup the <code>&quot;global&quot;</code> information of input, including paths and logging.</p><p><strong>Arguments</strong></p><ul><li><code>input::Dict</code>: The input file loaded into a <code>Dict</code></li><li><code>input_path::AbstractString</code>: The path to the input <code>.input</code> file (from which <code>input</code> is loaded)</li><li><code>verbose::Bool</code>: Whether or not to display <code>@debug</code> calls</li><li><code>paths::OrderedDict{String, Tuple{String, String}}</code>: Paths to expand. <code>paths</code> will be merged with the following <code>default_paths</code>, with <code>paths</code> taking preference. See <a href="#InputFiles.SetupModule.default_paths"><code>default_paths</code></a> for a the syntax of <code>paths</code></li><li><code>output_path::String</code>: The <code>&quot;path_name&quot;</code> of the directory where logging should output</li><li><code>test::Bool</code>: Whether this run is a test or not. This will decide whether to actually create directories, or log anything</li></ul><p>See also <a href="#InputFiles.SetupModule.setup_paths!-Tuple{Dict, OrderedCollections.OrderedDict{String, Tuple{String, String}}}"><code>setup_paths!</code></a>, and <a href="#InputFiles.SetupModule.setup_logging!"><code>setup_logging!</code></a></p><p><strong>Example</strong></p><pre><code class="language-julia hljs">input = Dict()
input_path = &quot;/path/to/input/file.input&quot;
setup_global!(input, input_path, false; test=true)
println(input)

# output

Dict{Any, Any}(&quot;global&quot; =&gt; Dict{Any, Any}(&quot;input_path&quot; =&gt; &quot;/path/to/input&quot;, &quot;logging&quot; =&gt; false, &quot;base_path&quot; =&gt; &quot;/path/to/input/&quot;, &quot;log_file&quot; =&gt; &quot;/path/to/input/Output/log.txt&quot;, &quot;output_path&quot; =&gt; &quot;/path/to/input/Output&quot;))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OmegaLambda1998/InputFiles.jl/blob/bcdb8cc50c8e66d77aaddf988206b57e09934413/src/SetupModule.jl#L143-L169">source</a></section></article><h3 id="Private-objects"><a class="docs-heading-anchor" href="#Private-objects">Private objects</a><a id="Private-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Private-objects" title="Permalink"></a></h3><p>These are the functions, types, and other objects which you don&#39;t have access to by default. They are included here for verbosity and developer assistance.</p><article class="docstring"><header><a class="docstring-binding" id="InputFiles.SetupModule.default_paths" href="#InputFiles.SetupModule.default_paths"><code>InputFiles.SetupModule.default_paths</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">default_paths::OrderedDict{String, Tuple{String, String}}</code></pre><p>The default paths which will be expanded into absolute paths and used throughout the project.</p><pre><code class="nohighlight hljs">default_paths::OrderedDict{String, Tuple{String, String}} = OrderedDict{String, Tuple{String, String}}(
    # Name =&gt; relative, default
    &quot;base_path&quot; =&gt; (&quot;input_path&quot;, &quot;&quot;),
    &quot;output_path&quot; =&gt; (&quot;base_path&quot;, &quot;Output&quot;)
)</code></pre><p>This dictionary maps <code>(&quot;path_name&quot; =&gt; (&quot;relative_name&quot;, &quot;default_path&quot;))</code>, where <code>&quot;path_name&quot;</code> is a human readable name for the path, <code>&quot;relative_name&quot;</code> is the name of the path which <code>&quot;path_name&quot;</code> is relative to, and <code>&quot;default_path&quot;</code> is the default value for the path (either absolute or relative). If <code>&quot;path_name&quot;</code> already exists inside <code>input[&quot;global&quot;]</code>, then that path will be used either as is (if an absolute path) or relative to <code>&quot;relative_name&quot;</code>, otherwise the <code>&quot;default_path&quot;</code> will be used</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OmegaLambda1998/InputFiles.jl/blob/bcdb8cc50c8e66d77aaddf988206b57e09934413/src/SetupModule.jl#L13-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InputFiles.SetupModule.setup_logger-Tuple{AbstractString, Bool}" href="#InputFiles.SetupModule.setup_logger-Tuple{AbstractString, Bool}"><code>InputFiles.SetupModule.setup_logger</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_logger(log_file::AbstractString, verbose::Bool)</code></pre><p>Helper function which sets up Logger formating and log level</p><p><strong>Arguments</strong></p><ul><li><code>log_file::AbstractString</code>: Path to log file</li><li><code>verbose::Bool</code>: Whether or not to display <code>@debug</code> calls</li></ul><p>See also <a href="#InputFiles.SetupModule.setup_logging!"><code>setup_logging!</code></a> and <a href="#InputFiles.SetupModule.setup_global!"><code>setup_global!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OmegaLambda1998/InputFiles.jl/blob/bcdb8cc50c8e66d77aaddf988206b57e09934413/src/SetupModule.jl#L98-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InputFiles.SetupModule.setup_logging!" href="#InputFiles.SetupModule.setup_logging!"><code>InputFiles.SetupModule.setup_logging!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">setup_logging!(input::Dict, output_path::String=&quot;output_path&quot;; log::Bool=true)</code></pre><p>Helper function which sets up log level, log files, etc... Assumes that <a href="#InputFiles.SetupModule.setup_paths!-Tuple{Dict, OrderedCollections.OrderedDict{String, Tuple{String, String}}}"><code>setup_paths!</code></a> has already been run on <code>input</code></p><p><strong>Arguments</strong></p><ul><li><code>input::Dict</code>: The input file we are modifying. This assumes that the input already has a <code>&quot;global&quot;</code> key with value <code>Dict{Any, Any}(&quot;input_path&quot;=&gt;&quot;/path/to/input&quot;), where</code>&quot;input_path&quot;` is the path to the input file</li><li><code>output_path::String</code>: The <code>&quot;path_name&quot;</code> of the output directory where log files should be written. See <a href="#InputFiles.SetupModule.default_paths"><code>default_paths</code></a> for more details</li></ul><p>See also <a href="#InputFiles.SetupModule.setup_global!"><code>setup_global!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OmegaLambda1998/InputFiles.jl/blob/bcdb8cc50c8e66d77aaddf988206b57e09934413/src/SetupModule.jl#L71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="InputFiles.SetupModule.setup_paths!-Tuple{Dict, OrderedCollections.OrderedDict{String, Tuple{String, String}}}" href="#InputFiles.SetupModule.setup_paths!-Tuple{Dict, OrderedCollections.OrderedDict{String, Tuple{String, String}}}"><code>InputFiles.SetupModule.setup_paths!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_paths!(input::Dict, paths::OrderedDict{String, Tuple{String, String}})</code></pre><p>Helper function which sets up paths, expanding relative paths and ensuring all interim directories exist</p><p><strong>Arguments</strong></p><ul><li><code>input::Dict</code>: The input file we are modifying. This assumes that the input already has a <code>&quot;global&quot;</code> key with value <code>Dict{Any, Any}(&quot;input_path&quot;=&gt;&quot;/path/to/input&quot;), where</code>&quot;input_path&quot;<code>is the path to the</code>input` file</li><li><code>paths::OrderedDict{String, Tuple{String, String}}</code>: Paths to expand. <code>paths</code> will be merged with the following <code>default_paths</code>, with <code>paths</code> taking preference. See <a href="#InputFiles.SetupModule.default_paths"><code>default_paths</code></a> for a the syntax of <code>paths</code></li></ul><p>See also <a href="#InputFiles.SetupModule.setup_global!"><code>setup_global!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OmegaLambda1998/InputFiles.jl/blob/bcdb8cc50c8e66d77aaddf988206b57e09934413/src/SetupModule.jl#L36-L46">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« InputFiles</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 19 January 2023 10:29">Thursday 19 January 2023</span>. Using Julia version 1.10.0-DEV.395.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
